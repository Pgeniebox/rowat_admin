<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Text to Canvas</title>
</head>
<body>
    <input type="text" id="textInput" placeholder="Enter text">
    <button onclick="generateImage()">GenerateImage</button>
    <img id="generatedImage" src="img.jpg" alt="Generated Image">
    
</body>
<script>
var previousDataURL = '';
let dataURL;
function generateImage() {
    var text = document.getElementById('textInput').value;
    var canvas = document.createElement('canvas');
    var ctx = canvas.getContext('2d');
    canvas.width = 20; // Adjust canvas size as needed
    canvas.height = 20;
    ctx.fillStyle = 'white';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = 'black';
    ctx.fillText(text, 10, 10);

     dataURL = canvas.toDataURL('image/jpeg');

    if (dataURL !== previousDataURL) {
        uploadImageToGitHub(dataURL);

        previousDataURL = dataURL;
    }
}

// Function to upload image to GitHub repo
function uploadImageToGitHub(dataURL) {


var base64Content = dataURL.split(',')[1]





fetch('https://api.github.com/repos/Pgeniebox/rowat_admin/contents/img.jpg', {
    method: 'GET',
    headers: {
        Authorization: 'Bearer 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'
    }
})
.then(response => response.json())
.then(data => {
    return fetch('https://api.github.com/repos/Pgeniebox/rowat_admin/contents/img.jpg', {
        method: 'PUT',
        headers: {
            Authorization: 'Bearer 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',
            'Content-Type': 'application/json'
        },
       
        body: JSON.stringify({
            message: 'k', 
content: btoa(base64Content),
        sha: data.sha
    })
})
.then(response => {
    if (response.ok) {
        console.log('Image uploaded successfully');
    } else {
        console.error('Failed to upload image');
    }
})
.catch(error => console.error('Error:', error));

});
}
// Function to periodically check for changes in image
setInterval(checkForChanges, 5000);

// Function to check for changes in image
function checkForChanges() {
    var image = document.getElementById('generatedImage');
    image.src = 'img.jpg';
    if (image) {
        var canvas = document.createElement('canvas');
        var ctx = canvas.getContext('2d');
        canvas.width = image.width;
        canvas.height = image.height;
        ctx.drawImage(image, 0, 0);
        var currentDataURL = canvas.toDataURL('image/jpeg');

        // Compare data URLs
        if (currentDataURL !== previousDataURL) {
            console.log('Test is OK');
            // Update previous data URL
            previousDataURL = currentDataURL;
        }
    }
}

</script>
</html>
